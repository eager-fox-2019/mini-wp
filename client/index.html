<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui">
  <title>MiniWP</title>

  <!--Google Related -->
  <script src="https://apis.google.com/js/platform.js" async defer></script>
  <meta name="google-signin-client_id" content="647749845083-l8k2ne6a9vc8sh103n7lv6ag92obmc11.apps.googleusercontent.com">

  <!-- Fontawesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">

  <!-- WYSIWYG -->
  <script src="https://cdn.ckeditor.com/ckeditor5/12.2.0/classic/ckeditor.js"></script>

  <!-- Vuetify -->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.css" rel="stylesheet">

  <!-- Internal resources -->
  <link rel="stylesheet" href="./css/main.css">
</head>
<body>
  <div id="app">
    <v-app>
      <v-toolbar app color="primary" dark fixed>
        <v-toolbar-side-icon v-if="isLogin" @click.stop="navTab.drawer = !navTab.drawer"></v-toolbar-side-icon>
        <v-toolbar-title href="#" @click="changePage('content-home')">
          <i id="navbar-logo" class="far fa-smile-wink valign-wrapper"></i>
          <span>Mini WP</span>
        </v-toolbar-title>
        <v-spacer></v-spacer>
        <v-toolbar-items class="">
          <v-btn v-if="!isLogin" flat @click="changePage('content-registration')">Login</v-btn>
          <v-btn v-if="isLogin" flat @click="logout()">Logout</v-btn>
          <v-btn v-if="isLogin" flat>{{ currentLoginUser.full_name }}</v-btn>
        </v-toolbar-items>
      </v-toolbar>
      <!-- List Articles Dashboard -->
      <v-content>
        <v-layout v-if="isLogin">
          <v-navigation-drawer v-model="navTab.drawer" absolute temporary>
            <v-list class="pa-1">
              <v-list-tile>
                <v-list-tile-title class="title">
                  Mini WP
                </v-list-tile-title>
              </v-list-tile>
            </v-list>
      
            <v-list class="pt-0" dense>
              <v-divider></v-divider>
              <v-list-tile v-for="menu in navTab.menus" :key="menu.title" @click="changePage(menu.pageName)">
                <v-list-tile-action>
                  <v-icon>{{ menu.icon }}</v-icon>
                </v-list-tile-action>
                <v-list-tile-content>
                  <v-list-tile-title>{{ menu.title }}</v-list-tile-title>
                </v-list-tile-content>
              </v-list-tile>
            </v-list>
          </v-navigation-drawer>
        </v-layout>
        <v-layout row v-if="isLogin && currentPage == 'content-list-articles'">
          <v-flex xs12 sm10 offset-sm1>
            <v-toolbar color="cyan" dark>
              <v-text-field v-model="searchArticle" label="Search Post Title"></v-text-field>
            </v-toolbar>
            <v-tabs v-model="articlesPage.activeTab" color="cyan" dark slider-color="yellow">
              <v-tab key="all-article" ripple>All Articles</v-tab>
              <v-tab key="published" ripple>Published</v-tab>
              <v-tab key="drafts" ripple>Drafts</v-tab>
              <v-tab-item key="all-article">
                <v-card flat>
                  <v-list two-line>
                    <template v-for="(item, index) in filteredArticlesAuthorAll">
                      <v-list-tile :key="item.title" avatar @click="">
                        <v-list-tile-avatar>
                          <img src="https://gagaldiett.files.wordpress.com/2018/10/img-1579-1.jpg?w=256&h=256&crop=1">
                        </v-list-tile-avatar>
                        <v-list-tile-content>
                          <v-list-tile-title v-html="item.title"></v-list-tile-title>
                          <v-list-tile-sub-title v-html="item.content"></v-list-tile-sub-title>
                        </v-list-tile-content>
                        <v-list-tile-action @click="changePage('content-edit-article', item._id)">
                          <v-btn icon>
                            <v-icon color="grey lighten-1">edit</v-icon>
                          </v-btn>
                        </v-list-tile-action>
                        <v-list-tile-action @click="deleteArticle(item._id)">
                          <v-btn icon>
                            <v-icon color="grey lighten-1">delete</v-icon>
                          </v-btn>
                        </v-list-tile-action>
                      </v-list-tile>
                    </template>
                  </v-list>
                </v-card>
              </v-tab-item>
              <v-tab-item key="published">
                <v-card flat>
                  <v-list two-line>
                    <template v-for="(item, index) in filteredArticlesAuthorPublished">
                      <v-list-tile :key="item.title" avatar @click="">
                        <v-list-tile-avatar>
                          <img src="https://gagaldiett.files.wordpress.com/2018/10/img-1579-1.jpg?w=256&h=256&crop=1">
                        </v-list-tile-avatar>
                        <v-list-tile-content>
                          <v-list-tile-title v-html="item.title"></v-list-tile-title>
                          <v-list-tile-sub-title v-html="item.content"></v-list-tile-sub-title>
                        </v-list-tile-content>
                        <v-list-tile-action @click="changePage('content-edit-article', item._id)">
                          <v-btn icon>
                            <v-icon color="grey lighten-1">edit</v-icon>
                          </v-btn>
                        </v-list-tile-action>
                        <v-list-tile-action @click="deleteArticle(item._id)">
                          <v-btn icon>
                            <v-icon color="grey lighten-1">delete</v-icon>
                          </v-btn>
                        </v-list-tile-action>
                      </v-list-tile>
                    </template>
                  </v-list>
                </v-card>
              </v-tab-item>
              <v-tab-item key="drafts">
                <v-card flat>
                    <v-list two-line>
                      <template v-for="(item, index) in filteredArticlesAuthorDraft">
                        <v-list-tile :key="item.title" avatar @click="">
                          <v-list-tile-avatar>
                            <img src="https://gagaldiett.files.wordpress.com/2018/10/img-1579-1.jpg?w=256&h=256&crop=1">
                          </v-list-tile-avatar>
                          <v-list-tile-content>
                            <v-list-tile-title v-html="item.title"></v-list-tile-title>
                            <v-list-tile-sub-title v-html="item.content"></v-list-tile-sub-title>
                          </v-list-tile-content>
                          <v-list-tile-action @click="changePage('content-edit-article', item._id)">
                            <v-btn icon>
                              <v-icon color="grey lighten-1">edit</v-icon>
                            </v-btn>
                          </v-list-tile-action>
                          <v-list-tile-action @click="deleteArticle(item._id)">
                            <v-btn icon>
                              <v-icon color="grey lighten-1">delete</v-icon>
                            </v-btn>
                          </v-list-tile-action>
                        </v-list-tile>
                      </template>
                    </v-list>
                </v-card>
              </v-tab-item>
            </v-tabs>
          </v-flex>
        </v-layout>
        <!-- Edit or Add Article -->
        <v-layout row v-if="isLogin && currentPage == 'content-edit-article'">
          <v-flex xs12 sm10 offset-sm1>
            <v-text-field v-model="selectedArticle.title" label="Title" required></v-text-field>
            <v-switch v-model="selectedArticle.published" :label="`Published: ${(selectedArticle.published) ? 'Published' : 'Drafts'}`"></v-switch>
            <textarea name="content" id="editor" v-model="selectedArticle.content"></textarea>
            <v-btn color="success" @click="sendArticle(selectedArticle._id)">Submit</v-btn>
            <v-btn color="error" @click="changePage('content-list-articles')">Cancel</v-btn>
          </v-flex>
        </v-layout>
        <!-- Login Register Form -->
        <v-layout row v-if="currentPage == 'content-registration'">
          <v-flex xs12 sm8 offset-sm2>
            <v-tabs v-model="logRegForm.activeTab" color="cyan" dark slider-color="yellow">
              <v-tab key="login" ripple>Login</v-tab>
              <v-tab key="registration" ripple>Registration</v-tab>
              <v-tab-item key="login">
                <v-card flat>
                  <form>
                    <v-text-field v-model="logRegForm.loginUser.username" label="Username" required></v-text-field>
                    <v-text-field v-model="logRegForm.loginUser.password" :type="'password'" label="Password" required></v-text-field>
                    <v-btn @click="defaultLogin()">Login</v-btn>
                    <p>Or sign in using Google</p>
                    <div class="g-signin2" @done="onSignIn"></div>
                  </form>
                </v-card>
              </v-tab-item>
              <v-tab-item key="registration">
                <v-card flat>
                  <form>
                    <v-text-field v-model="logRegForm.registerUser.full_name" label="Full Name" required></v-text-field>
                    <v-text-field v-model="logRegForm.registerUser.username" label="Username" required></v-text-field>
                    <v-text-field v-model="logRegForm.registerUser.password" label="Password" :type="'password'" required></v-text-field>
                    <v-text-field v-model="logRegForm.registerUser.email" label="Email" required></v-text-field>
                    <v-btn @click="sendRegisterUser()">Register</v-btn>
                  </form>
                </v-card>
              </v-tab-item>
            </v-tabs>
          </v-flex>
        </v-layout>
        <!-- Home Page -->
        <v-container id="content-home" v-if="currentPage == 'content-home'">
          <v-layout row wrap>
            <v-flex v-for="article in allArticlesPublished" :key="article._id">
              <v-card>
                <v-img src="https://cdn.vuetifyjs.com/images/cards/desert.jpg" aspect-ratio="2.75"></v-img>
                <v-card-title primary-title>
                  <div>
                    <v-card-title> 
                      <h3 class="headline mb-0">{{ article.title }}</h3>
                    </v-card-title>
                    <v-card-text> {{ article.content }} </v-card-text>
                    <v-card-text>
                      <small> By: {{ article.user_id.full_name }} </small>
                      <small> {{ article.createdAt }} </small>
                    </v-card-text>
                  </div>
                </v-card-title>
        
                <v-card-actions>
                  <v-btn flat color="orange">Share</v-btn>
                  <v-btn flat color="orange">Explore</v-btn>
                </v-card-actions>
              </v-card>
            </v-flex>
          </v-layout>
        </v-container>
        <!-- Detail Page -->
        <div id="content-detail-page" v-if="currentPage == 'content-detail-page'">
          Ini Detail page
        </div>
      </v-content>
    </v-app>
  </div>
  <!-- Compiled and minified JavaScript -->
  <script src="https://unpkg.com/axios/dist/axios.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/locale/en-gb.js"></script>
  <script src="./js/wysiwyg.js"></script>
  <script src="./js/main.js"></script>
</body>
</html>